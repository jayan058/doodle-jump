(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))I(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const L of i.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&I(L)}).observe(document,{childList:!0,subtree:!0});function f(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function I(r){if(r.ep)return;r.ep=!0;const i=f(r);fetch(r.href,i)}})();let g,m=360,p=576,a,A=46,S=46,B=m/2-A/2,E=p*7/8-S,s,M,o={img:null,x:B,y:E,width:A,height:S},P=0,l=0,c=-10,x=.2,d=[],k=60,v=18,h,u,y=0,n=0,w=!1;window.onload=()=>{g=document.getElementById("board"),g.height=p,g.width=m,a=g.getContext("2d"),s=new Image,s.src="./assets/doodler-right.png",s.onload=()=>{o.img=s,O()},s.onerror=b,M=new Image,M.src="./assets/doodler-left.png",M.onerror=b,h=new Image,h.src="./assets/platform.png",h.onload=()=>{O()},h.onerror=b,u=new Image,u.src="./assets/platform-broken.png",u.onload=()=>{O()},u.onerror=b};function b(){console.error("Failed to load image.")}function O(){s.complete&&h.complete&&u.complete&&(l=c,X(),requestAnimationFrame(F),document.addEventListener("keydown",q))}function F(){if(requestAnimationFrame(F),!w){a.clearRect(0,0,g.width,g.height),o.x+=P,o.x>m?o.x=0:o.x+o.width<0&&(o.x=m),l+=x,o.y+=l,o.y>g.height&&(w=!0),a.drawImage(o.img,o.x,o.y,o.width,o.height);for(let t=0;t<d.length;t++){let e=d[t];l<0&&o.y<p*3/4&&(e.y-=c),K(o,e)&&(e.broken&&o.y+o.height<=e.y+l?w=!0:!e.broken&&l>=0&&(l=c)),a.drawImage(e.img,e.x,e.y,e.width,e.height)}for(;d.length>0&&d[0].y>=p;)d.shift(),H();N(),a.fillStyle="black",a.font="16px sans-serif",a.fillText(y.toString(),5,20),w&&a.fillText("Opps!! Press Space to restart",m/4,p*7/8)}}function q(t){t.code==="ArrowRight"||t.code==="KeyD"?(P=4,o.img=s):t.code==="ArrowLeft"||t.code==="KeyA"?(P=-4,o.img=M):t.code==="Space"&&w&&(o={img:s,x:B,y:E,width:A,height:S},P=0,l=c,y=0,n=0,w=!1,X())}function X(){d=[];let t={img:h,x:m/2,y:p-50,width:k,height:v,broken:!1};d.push(t);let e=75;for(let f=0;f<6;f++){let I=Math.floor(Math.random()*m*3/4),r=Math.random()<.2;f===0&&(r=!1),t={img:r?u:h,x:I,y:p-e*f-150,width:k,height:v,broken:r},d.push(t),y>1e3&&(e=100),y>2e3&&(e=125),y>3e3&&(e=150)}}function H(){let t=Math.floor(Math.random()*m*3/4),e=Math.random()<.2,f={img:e?u:h,x:t,y:-v,width:k,height:v,broken:e};d.push(f)}function K(t,e){return e.broken?!1:t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function N(){let t=Math.floor(50*Math.random());l<0?(n+=t,y<n&&(y=n)):l>=0&&(n-=t),n>1e3?(x=.25,c=-6.5):n>2e3?(x=.3,c=-7):n>3e3?(x=.35,c=-7.5):n>4e3&&(x=.4,c=-8)}
